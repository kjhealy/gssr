<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>An Overview of gssr • gssr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Overview of gssr">
<meta property="og:description" content="gssr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gssr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">An Overview of gssr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kjhealy/gssr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Overview of gssr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kjhealy/gssr/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="hidden name"><code>overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="http://gss.norc.org" class="external-link">General Social Survey</a>, or GSS,
is one of the cornerstones of American social science and one of the
most-analyzed datasets in Sociology. It is routinely used in research,
in teaching, and as a reference point in discussions about changes in
American society since the early 1970s. It is also a model of open,
public data. The <a href="http://norc.org" class="external-link">National Opinion Research
Center</a> already provides many excellent tools for working with the
data, and has long made it freely available to researchers. Casual users
of the GSS can examine the <a href="https://gssdataexplorer.norc.org" class="external-link">GSS Data Explorer</a>, and
social scientists can <a href="http://gss.norc.org/Get-The-Data" class="external-link">download complete datasets</a>
directly. At present, the GSS is provided to researchers in a variety of
commercial formats: Stata (<code>.dta</code>), SAS, and SPSS
(<code>.sav</code>). It’s not too difficult to get the data into R using
the <a href="http://haven.tidyverse.org" class="external-link">Haven</a> package, but it can
be a little annoying to have to do it repeatedly, or across projects.
After doing it one too many times, I got tired of it and I made a
package instead. Currently, the <code>gssr</code> package provides
Release 2a the GSS Cumulative Data File (1972-2022); three GSS Three
Wave Panel Data Files (for panels beginning in 2006, 2008, and 2010,
respectively); and the 2020 panel file. The package also integrates
codebook information about variables into R’s help system, allowing them
to be accessed via the help browser or from the console with
<code>?</code>. The <code>gssr</code> package makes the GSS a little
more accessible to users of R, the free software environment for
statistical computing, and thus helps in a small way to make the GSS
even more open than it already is.</p>
<div class="section level3">
<h3 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h3>
<p>This article makes use of some additional packages beyond
<code>gssr</code> itself. My assumption is that users of
<code>gssr</code> will most likely use and analyze the data in
conjunction with some combination of <a href="https://tidyverse.org" class="external-link">Tidyverse</a> tools and the <a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a>, <a href="https://github.com/gergness/srvyr" class="external-link">srvyr</a>, and <a href="http://panelr.jacob-long.com" class="external-link">panelr</a> packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org" class="external-link">haven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: grid</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: survival</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'survey'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     dotchart</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gdfe.co/srvyr/" class="external-link">srvyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'srvyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-the-gssr-package-and-its-data">Load the gssr package and its data<a class="anchor" aria-label="anchor" href="#load-the-gssr-package-and-its-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kjhealy/gssr" class="external-link">gssr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Package loaded. To attach the GSS data, type data(gss_all) at the console.</span></span>
<span><span class="co">#&gt; For the codebook, type data(gss_dict).</span></span>
<span><span class="co">#&gt; For the panel data and documentation, type e.g. data(gss_panel08_long) and data(gss_panel_doc).</span></span>
<span><span class="co">#&gt; For help on a specific GSS variable, type ?varname at the console.</span></span></code></pre></div>
<p>We will begin with the Cumulative Data file (1972-2022). As the
startup message notes, the data objects are not automatically loaded.
That is, we do not use R’s “lazy loading” functionality. This is because
the main GSS dataset is rather large. Instead we load it manually with
<code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>. For the purposes of this vignette, because the full
Cumulative Data object is big, we will use just a few columns of it
stored in an object called <code>gss_sub</code>. But all the code here
will also work with the full dataset object, <code>gss_all</code>, which
you can load with the command <code>data(gss_all)</code>. We will also
load the tibble that contains summary information for the variables in
the Cumulative Data File. This is called <code>gss_dict</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gss_sub</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gss_dict</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_dict</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,663 × 12</span></span></span>
<span><span class="co">#&gt;      pos variable label     missing var_doc_label value_labels var_text years   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 year     gss year…       0 gss year for… [NA(d)] don… None     <span style="color: #949494;">&lt;NULL&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 wrkstat  labor fo…      36 labor force … [1] working… 1. Last… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 hrs1     number o…   <span style="text-decoration: underline;">30</span>830 number of ho… [89] 89+ ho… 1a. If … <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 hrs2     number o…   <span style="text-decoration: underline;">70</span>989 number of ho… [89] 89+ ho… 1b. If … <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 evwork   ever wor…   <span style="text-decoration: underline;">46</span>944 ever work as… [1] yes; [2… 1c. If … <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 occ      r's cens…   <span style="text-decoration: underline;">48</span>123 r's census o… [NA(d)] don… 2a. Wha… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 prestige r's occu…   <span style="text-decoration: underline;">48</span>123 r's occupati… [NA(d)] don… 2a. Wha… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 wrkslf   r self-e…    <span style="text-decoration: underline;">4</span>041 r self-emp o… [1] self-em… 2e. (Ar… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 wrkgovt  govt or …   <span style="text-decoration: underline;">44</span>311 govt or priv… [1] governm… 2f. (Ar… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 commute  travel t…   <span style="text-decoration: underline;">71</span>060 travel time … [97] 97+ mi… 2g. Abo… <span style="color: #949494;">&lt;tibble&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6,653 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: var_yrtab &lt;list&gt;, col_type &lt;chr&gt;, var_type &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   var_na_codes &lt;chr&gt;</span></span></span></code></pre></div>
<p>The GSS data comes in a <em>labelled</em> format, mirroring the way
it is encoded for Stata and SPSS platforms. The numeric codes are the
content of the column cells. The labeling information is stored as an
attribute of the column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_sub</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 72,390 × 20</span></span></span>
<span><span class="co">#&gt;    year         id ballot      age   race    sex     degree  padeg   madeg      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>972          1 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 23    1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> 3<span style="color: #949494;"> [bac…</span> 0<span style="color: #949494;"> [les…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>972          2 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 70    1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> 0<span style="color: #949494;"> [les…</span> 0<span style="color: #949494;"> [les…</span>     0<span style="color: #949494;"> [les…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>972          3 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 48    1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> 1<span style="color: #949494;"> [hig…</span> 0<span style="color: #949494;"> [les…</span>     0<span style="color: #949494;"> [les…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>972          4 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 27    1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> 3<span style="color: #949494;"> [bac…</span> 3<span style="color: #949494;"> [bac…</span>     1<span style="color: #949494;"> [hig…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>972          5 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 61    1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> 1<span style="color: #949494;"> [hig…</span> 0<span style="color: #949494;"> [les…</span>     0<span style="color: #949494;"> [les…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>972          6 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 26    1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> 1<span style="color: #949494;"> [hig…</span> 3<span style="color: #949494;"> [bac…</span>     4<span style="color: #949494;"> [gra…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>972          7 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 28    1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> 1<span style="color: #949494;"> [hig…</span> 3<span style="color: #949494;"> [bac…</span>     1<span style="color: #949494;"> [hig…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>972          8 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 27    1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> 3<span style="color: #949494;"> [bac…</span> 3<span style="color: #949494;"> [bac…</span>     1<span style="color: #949494;"> [hig…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>972          9 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 21    2<span style="color: #949494;"> [bla…</span> 2<span style="color: #949494;"> [fem…</span> 1<span style="color: #949494;"> [hig…</span> 1<span style="color: #949494;"> [hig…</span>     1<span style="color: #949494;"> [hig…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>972         10 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 30    2<span style="color: #949494;"> [bla…</span> 2<span style="color: #949494;"> [fem…</span> 1<span style="color: #949494;"> [hig…</span> 0<span style="color: #949494;"> [les…</span>     0<span style="color: #949494;"> [les…</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 72,380 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more variables: relig &lt;dbl+lbl&gt;, polviews &lt;dbl+lbl&gt;, fefam &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   vpsu &lt;dbl+lbl&gt;, vstrat &lt;dbl+lbl&gt;, oversamp &lt;dbl+lbl&gt;, formwt &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   wtssall &lt;dbl+lbl&gt;, wtssps &lt;dbl+lbl&gt;, sampcode &lt;dbl+lbl&gt;, sample &lt;dbl+lbl&gt;</span></span></span></code></pre></div>
<p>We will use the label information later when recoding the variables
into, say, character or factor variables.</p>
</div>
<div class="section level2">
<h2 id="descriptive-analysis-of-the-data-an-example">Descriptive analysis of the data: an example<a class="anchor" aria-label="anchor" href="#descriptive-analysis-of-the-data-an-example"></a>
</h2>
<p>The GSS is a complex survey. When working with it, we need to take
its structure into account in order to properly calculate statistics
such as the population mean for a variable in some year, its standard
error, and so on. For these tasks we use the <code>survey</code> and
<code>srvyr</code> packages. For details on <code>survey</code>, see
Lumley (2010). We will also do some recoding prior to analyzing the
data, so we load several additional <code>tidyverse</code> packages to
assist us.</p>
<p>We will examine a topic that was the subject of recent media
attention, in the <em>New York Times</em> and elsewhere, regarding the
beliefs of young men about gender roles. Some surveys seemed to point to
some recent increasing conservatism on this front amongst young men. As
it happens, the GSS has a longstanding question named
<code>fefam</code>, where respondents are asked to give their opinion on
the following statement:</p>
<blockquote>
<p>It is much better for everyone involved if the man is the achiever
outside the home and the woman takes care of the home and family.</p>
</blockquote>
<p>Respondents may answer that they Strongly Agree, Agree, Disagree, or
Strongly Disagree with the statement (as well as refusing to answer, or
saying they don’t know).</p>
<div class="section level3">
<h3 id="look-at-the-variables-summary">Look at the Variable’s summary<a class="anchor" aria-label="anchor" href="#look-at-the-variables-summary"></a>
</h3>
<p>Variable summaries for the cumulative data file are built in to
<code>gssr</code> and are integrated into R’s help system. For example,
we can type <code><a href="../reference/fefam.html">?fefam</a></code> at the console and have the variable’s
documentation appear in the documentation browser.</p>
<p><img src="figures/fefam_help.png"></p>
<p>Scrolling further down will give a summary of the values the variable
can take.</p>
</div>
<div class="section level3">
<h3 id="subset-the-data">Subset the Data<a class="anchor" aria-label="anchor" href="#subset-the-data"></a>
</h3>
<p>The GSS data retains labeling information (as it was originally
imported via the <code>haven</code> package). When working with the data
in an analysis, we will probably want to convert the labeled variables
to data types such as factors. This should be done with care (and not on
the whole dataset all at once). Typically, we will want to focus on some
relatively small subset of variables and examine those. For example,
let’s say we want to explore the <code>fefam</code> question. We will
subset the data and then prepare that for analysis. Here we are going to
subset <code>gss_sub</code> into an object called <code>gss_fam</code>
containing just the variables we want to examine, along with core
measures that identify respondents (such as <code>id</code> and
<code>year</code>) and variables necessary for the survey weighting
later (such as <code>wtssps</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cont_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"id"</span>, <span class="st">"ballot"</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cat_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"sex"</span>, <span class="st">"fefam"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wt_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vpsu"</span>,</span>
<span>             <span class="st">"vstrat"</span>,</span>
<span>             <span class="st">"oversamp"</span>,</span>
<span>             <span class="st">"formwt"</span>,              <span class="co"># weight to deal with experimental randomization</span></span>
<span>             <span class="st">"wtssps"</span>,              <span class="co"># weight variable</span></span>
<span>             <span class="st">"sampcode"</span>,            <span class="co"># sampling error code</span></span>
<span>             <span class="st">"sample"</span><span class="op">)</span>              <span class="co"># sampling frame and method</span></span>
<span></span>
<span><span class="va">my_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cont_vars</span>, <span class="va">cat_vars</span>, <span class="va">wt_vars</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_fam</span> <span class="op">&lt;-</span> <span class="va">gss_sub</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">my_vars</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_fam</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 72,390 × 14</span></span></span>
<span><span class="co">#&gt;    year         id ballot      age       race    sex     fefam       vpsu       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>972          1 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 23        1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>972          2 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 70        1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>972          3 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 48        1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>972          4 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 27        1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>972          5 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 61        1<span style="color: #949494;"> [whi…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>972          6 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 26        1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>972          7 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 28        1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>972          8 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 27        1<span style="color: #949494;"> [whi…</span> 1<span style="color: #949494;"> [mal…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>972          9 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 21        2<span style="color: #949494;"> [bla…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>972         10 <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> 30        2<span style="color: #949494;"> [bla…</span> 2<span style="color: #949494;"> [fem…</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span> <span style="color: #BB0000;">NA(i)</span><span style="color: #949494;"> [iap]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 72,380 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: vstrat &lt;dbl+lbl&gt;, oversamp &lt;dbl+lbl&gt;, formwt &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   wtssps &lt;dbl+lbl&gt;, sampcode &lt;dbl+lbl&gt;, sample &lt;dbl+lbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recode-the-subsetted-data">Recode the Subsetted Data<a class="anchor" aria-label="anchor" href="#recode-the-subsetted-data"></a>
</h3>
<p>Next, we will do some recoding and create some new variables. We also
create some new variables: age quintiles, a variable flagging whether a
respondent is 25 or younger, recoded <code>fefam</code> to binary
“Agree” or “Disagree” (with non-responses dropped).</p>
<p>We begin by figuring out the cutpoints for age quintiles.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qrts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">gss_fam</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>                 na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">qrts</span></span>
<span><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span><span class="co">#&gt;   18   32   44   60   89</span></span>
<span></span>
<span><span class="va">quintiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">gss_fam</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>                      probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">quintiles</span></span>
<span><span class="co">#&gt;   0%  20%  40%  60%  80% 100% </span></span>
<span><span class="co">#&gt;   18   29   39   50   64   89</span></span></code></pre></div>
<p>Next, we clean up <code>gss_fam</code> a bit, discarding some of the
label and missing value information we don’t need. The data in
<code>gss_all</code> retains the labeling structure provided by the GSS.
Variables are stored numerically with labels attached to them. Often,
when using the data in R, it will be convenient to convert the
categorical variables we are interested in to character or factor type
instead.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Recoding</span></span>
<span><span class="co">## The convert_agegrp() and capwords() functions seen here are defined</span></span>
<span><span class="co">## at the top of the Rmd file used to produce this document.</span></span>
<span></span>
<span><span class="va">gss_fam</span> <span class="op">&lt;-</span> <span class="va">gss_fam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Convert all missing to NA</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">haven</span><span class="fu">::</span><span class="va"><a href="https://haven.tidyverse.org/reference/zap_missing.html" class="external-link">zap_missing</a></span><span class="op">)</span>, </span>
<span>    <span class="co"># Convert all weight vars to numeric</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">wt_vars</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span>,</span>
<span>    <span class="co"># Make all categorical variables factors and relabel nicely</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">cat_vars</span><span class="op">)</span>, <span class="fu">forcats</span><span class="fu">::</span><span class="va"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">cat_vars</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relabel.html" class="external-link">fct_relabel</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">capwords</span>, strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Create the age groups</span></span>
<span>    ageq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">qrts</span><span class="op">)</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ageq <span class="op">=</span>  <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relabel.html" class="external-link">fct_relabel</a></span><span class="op">(</span><span class="va">ageq</span>, <span class="va">convert_agegrp</span><span class="op">)</span>, </span>
<span>    agequint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">quintiles</span><span class="op">)</span>, include.lowest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    agequint <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relabel.html" class="external-link">fct_relabel</a></span><span class="op">(</span><span class="va">agequint</span>, <span class="va">convert_agegrp</span><span class="op">)</span>,</span>
<span>    year_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    young <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">26</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Dichotomize fefam</span></span>
<span>    fefam <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">fefam</span>, <span class="cn">NULL</span> <span class="op">=</span> <span class="st">"IAP"</span>, <span class="cn">NULL</span> <span class="op">=</span> <span class="st">"DK"</span>, <span class="cn">NULL</span> <span class="op">=</span> <span class="st">"NA"</span><span class="op">)</span>,</span>
<span>    fefam_d <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html" class="external-link">fct_recode</a></span><span class="op">(</span><span class="va">fefam</span>,</span>
<span>                                  Agree <span class="op">=</span> <span class="st">"Strongly Agree"</span>,</span>
<span>                                  Disagree <span class="op">=</span> <span class="st">"Strongly Disagree"</span><span class="op">)</span>,</span>
<span>    fefam_n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">fefam_d</span>, <span class="st">"Agree"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"Disagree"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    samplerc <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">~</span> <span class="fl">3</span>, </span>
<span>                              <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">~</span> <span class="fl">6</span>,</span>
<span>                              .default <span class="op">=</span> <span class="va">sample</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Some of the recoded variables</span></span>
<span><span class="va">gss_fam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1976</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">race</span><span class="op">:</span><span class="va">fefam</span>, <span class="va">agequint</span><span class="op">:</span><span class="va">fefam_d</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">year_f</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 64,800 × 7</span></span></span>
<span><span class="co">#&gt;    year_f race  sex    fefam             agequint  young fefam_d </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1977   White Female Agree             Age 50-64 No    Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1977   White Female Agree             Age 29-39 No    Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1977   White Male   Strongly Agree    Age 64+   No    Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1977   White Male   Strongly Disagree Age 18-29 No    Disagree</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1977   White Female Agree             Age 18-29 Yes   Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1977   White Male   Disagree          Age 29-39 No    Disagree</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1977   White Female Agree             Age 64+   No    Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1977   White Female Disagree          Age 29-39 No    Disagree</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1977   White Female Agree             Age 64+   No    Agree   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1977   White Female Disagree          Age 39-50 No    Disagree</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 64,790 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="integrate-the-survey-weights">Integrate the Survey Weights<a class="anchor" aria-label="anchor" href="#integrate-the-survey-weights"></a>
</h3>
<p>At this point we can calculate some percentages, such as the percent
of male and female respondents disagreeing with the <code>fefam</code>
proposition each year.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_fam</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">sex</span>, <span class="va">young</span>, <span class="va">fefam_d</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 184 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   year, sex, young [92]</span></span></span>
<span><span class="co">#&gt;    year      sex    young fefam_d    pct</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>977      Male   No    Agree     71.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>977      Male   No    Disagree  28.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>977      Male   Yes   Agree     54.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>977      Male   Yes   Disagree  45.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>977      Female No    Agree     66.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>977      Female No    Disagree  33.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>977      Female Yes   Agree     41.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>977      Female Yes   Disagree  58.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>985      Male   No    Agree     53.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>985      Male   No    Disagree  46.4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 174 more rows</span></span></span></code></pre></div>
<p>However, these calculations do not take the GSS survey design into
account. We set up the data so we can properly calculate population
means and errors and so on. We use the <code>svyr</code> package’s
wrappers to <code>survey</code> for this.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>survey.lonely.psu <span class="op">=</span> <span class="st">"adjust"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>na.action<span class="op">=</span><span class="st">"na.pass"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_svy</span> <span class="op">&lt;-</span> <span class="va">gss_fam</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">1974</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">fefam_d</span>, <span class="va">young</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>stratvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">vstrat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="http://gdfe.co/srvyr/reference/as_survey_design.html" class="external-link">as_survey_design</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">vpsu</span>,</span>
<span>                     strata <span class="op">=</span> <span class="va">stratvar</span>,</span>
<span>                     weights <span class="op">=</span> <span class="va">wtssps</span>,</span>
<span>                     nest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>gss_svy</code> object contains the same data as
<code>gss_fam</code>, but incorporates information about the sampling
structure in a way that the <code>survey</code> package’s functions can
work with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_svy</span></span>
<span><span class="co">#&gt; Stratified 1 - level Cluster Sampling design (with replacement)</span></span>
<span><span class="co">#&gt; With (5977) clusters.</span></span>
<span><span class="co">#&gt; Called via srvyr</span></span>
<span><span class="co">#&gt; Sampling variables:</span></span>
<span><span class="co">#&gt;  - ids: vpsu</span></span>
<span><span class="co">#&gt;  - strata: stratvar</span></span>
<span><span class="co">#&gt;  - weights: wtssps</span></span>
<span><span class="co">#&gt; Data variables: year (dbl+lbl), id (dbl), ballot (dbl+lbl), age (dbl+lbl), race</span></span>
<span><span class="co">#&gt;   (fct), sex (fct), fefam (fct), vpsu (dbl), vstrat (dbl), oversamp (dbl),</span></span>
<span><span class="co">#&gt;   formwt (dbl), wtssps (dbl), sampcode (dbl), sample (dbl), ageq (fct),</span></span>
<span><span class="co">#&gt;   agequint (fct), year_f (fct), young (chr), fefam_d (fct), fefam_n (dbl),</span></span>
<span><span class="co">#&gt;   samplerc (dbl), stratvar (fct)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-the-survey-weighted-statistics">Calculate the survey-weighted statistics<a class="anchor" aria-label="anchor" href="#calculate-the-survey-weighted-statistics"></a>
</h3>
<p>We’re now in a position to calculate some properly-weighted summary
statistics for the variable we’re interested in, for every year it is in
the data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get the breakdown for every year</span></span>
<span><span class="va">out_ff</span> <span class="op">&lt;-</span> <span class="va">gss_svy</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">sex</span>, <span class="va">young</span>, <span class="va">fefam_d</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="http://gdfe.co/srvyr/reference/survey_mean.html" class="external-link">survey_mean</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, vartype <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_ff</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 184 × 7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   year, sex, young [92]</span></span></span>
<span><span class="co">#&gt;    year      sex    young fefam_d   prop prop_low prop_upp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>977      Male   No    Agree    0.708    0.662    0.754</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>977      Male   No    Disagree 0.292    0.246    0.338</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>977      Male   Yes   Agree    0.544    0.461    0.627</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>977      Male   Yes   Disagree 0.456    0.373    0.539</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>977      Female No    Agree    0.673    0.636    0.711</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>977      Female No    Disagree 0.327    0.289    0.364</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>977      Female Yes   Agree    0.417    0.312    0.522</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>977      Female Yes   Disagree 0.583    0.478    0.688</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>985      Male   No    Agree    0.541    0.489    0.594</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>985      Male   No    Disagree 0.459    0.406    0.511</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 174 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-the-results">Plot the Results<a class="anchor" aria-label="anchor" href="#plot-the-results"></a>
</h3>
<p>We finish with a polished plot of the trends in <code>fefam</code>
over time, for men and women in two (recoded) age groups over time.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">facet_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span> <span class="op">=</span> <span class="st">"Age Over 25 when surveyed"</span>, </span>
<span>                 <span class="st">"Yes"</span> <span class="op">=</span> <span class="st">"Age 18-25 when surveyed"</span><span class="op">)</span></span>
<span><span class="va">fefam_txt</span> <span class="op">&lt;-</span> <span class="st">"Disagreement with the statement, ‘It is much better for\neveryone involved if the man is the achiever outside the\nhome and the woman takes care of the home and family’"</span></span>
<span></span>
<span><span class="va">out_ff</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fefam_d</span> <span class="op">==</span> <span class="st">"Disagree"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> </span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">prop</span>,</span>
<span>               ymin <span class="op">=</span> <span class="va">prop_low</span>, </span>
<span>               ymax <span class="op">=</span> <span class="va">prop_upp</span>,</span>
<span>               color <span class="op">=</span> <span class="va">sex</span>, </span>
<span>               group <span class="op">=</span> <span class="va">sex</span>, </span>
<span>               fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1978</span>, <span class="fl">2022</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">my_colors</span><span class="op">(</span><span class="st">"bly"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>,</span>
<span>                     guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">my_colors</span><span class="op">(</span><span class="st">"bly"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>,</span>
<span>                    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">young</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="va">facet_names</span><span class="op">)</span>,</span>
<span>             ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1977</span>, <span class="fl">2022</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Percent Disagreeing"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="va">fefam_txt</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Kieran Healy http://socviz.co.\n</span></span>
<span><span class="st">         Data source: General Social Survey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="overview_files/figure-html/fefamplot-1.png" width="1600"></p>
</div>
</div>
<div class="section level2">
<h2 id="the-gss-three-wave-panels">The GSS Three Wave Panels<a class="anchor" aria-label="anchor" href="#the-gss-three-wave-panels"></a>
</h2>
<p>In addition to the Cumulative Data File, the gssr package also
includes the GSS’s panel data. The current rotating panel design began
in 2006. A panel of respondents were interviewed that year and followed
up on for further interviews in 2008 and 2010. A second panel was
interviewed beginning in 2008, and was followed up on for further
interviews in 2010 and 2012. And a third panel began in 2010, with
follow-up interviews in 2012 and 2014. The <code>gssr</code> package
provides three datasets, one for each of three-wave panels. They are
<code>gss_panel06_long</code>, <code>gss_panel08_long</code>, and
<code>gss_panel10_long</code>. The datasets are provided by the GSS in
wide format but (as their names suggest) are packaged here in long
format. The conversion was carried out using the <a href="https://panelr.jacob-long.com" class="external-link"><code>panelr</code> package</a> and
its <code>long_panel()</code> function. Conversion from long back to
wide format is possible with the tools provided in
<code>panelr</code>.</p>
<p>We load the panel data as before. For example:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gss_panel06_long</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_panel06_long</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,000 × 1,572</span></span></span>
<span><span class="co">#&gt;    firstid  wave ballot      form    formwt oversamp sampcode sample  samptype  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lb&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9           1 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 9           2 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 9           3 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10          1 1<span style="color: #949494;"> [BALLOT …</span> 1<span style="color: #949494;"> [STA…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10          2 1<span style="color: #949494;"> [BALLOT …</span> 1<span style="color: #949494;"> [STA…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10          3 1<span style="color: #949494;"> [BALLOT …</span> 1<span style="color: #949494;"> [STA…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 11          1 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 11          2 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 11          3 3<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 12          1 1<span style="color: #949494;"> [BALLOT …</span> 2<span style="color: #949494;"> [ALT…</span>      1        1 501      9<span style="color: #949494;"> [200…</span> <span style="text-decoration: underline;">2</span>006<span style="color: #949494;"> [200…</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,563 more variables: vstrat &lt;dbl+lbl&gt;, vpsu &lt;dbl+lbl&gt;, wtpan12 &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   wtpan123 &lt;dbl+lbl&gt;, wtpannr12 &lt;dbl+lbl&gt;, wtpannr123 &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   letin1a &lt;dbl+lbl&gt;, abany &lt;dbl+lbl&gt;, abdefect &lt;dbl+lbl&gt;, abhlth &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   abnomore &lt;dbl+lbl&gt;, abpoor &lt;dbl+lbl&gt;, abrape &lt;dbl+lbl&gt;, absingle &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   accntsci &lt;dbl+lbl&gt;, acqasian &lt;dbl+lbl&gt;, acqattnd &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   acqblack &lt;dbl+lbl&gt;, acqbrnda &lt;dbl+lbl&gt;, acqchild &lt;dbl+lbl&gt;, …</span></span></span></code></pre></div>
<p>The panel data objects were created by <code>panelr</code> but are
regular tibbles. The column names in long format do not have wave
identifiers. Rather, <code>firstid</code> and <code>wave</code>
variables track the cases. The <code>firstid</code> variable is unique
for every row and has no missing values. The <code>id</code> variable is
from the GSS and tracks individuals within waves.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_panel06_long</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">firstid</span>, <span class="va">wave</span>, <span class="va">id</span>, <span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,000 × 4</span></span></span>
<span><span class="co">#&gt;    firstid  wave id        sex       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 9           1    9      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 9           2 <span style="text-decoration: underline;">3</span>001      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 9           3 <span style="text-decoration: underline;">6</span>001      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10          1   10      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10          2 <span style="text-decoration: underline;">3</span>002      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10          3 <span style="text-decoration: underline;">6</span>002      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 11          1   11      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 11          2 <span style="text-decoration: underline;">3</span>003      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 11          3 <span style="text-decoration: underline;">6</span>003      2<span style="color: #949494;"> [FEMALE]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 12          1   12      1<span style="color: #949494;"> [MALE]</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,990 more rows</span></span></span></code></pre></div>
<p>We can look at attrition across waves with, e.g.:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gss_panel06_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">wave</span>, <span class="va">id</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">wave</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>observed <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>            missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;    wave observed missing</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     <span style="text-decoration: underline;">2</span>000       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2     <span style="text-decoration: underline;">1</span>537     464</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3     <span style="text-decoration: underline;">1</span>277     724</span></span></code></pre></div>
<p>The documentation tibble for the panel data is called
<code>gss_panel_doc</code>. It does not include information for the 2020
panel.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gss_panel_doc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_panel_doc</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 628 × 9</span></span></span>
<span><span class="co">#&gt;    id       description text  properties_1 properties_2 properties_3 marginals_1</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> caseid   CASEID      None  <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;NULL&gt;</span>       <span style="color: #949494;">&lt;NULL&gt;</span>       <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> year     YEAR        None  <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> id       ID          None  <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> age      AGE         13. … <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> sex      SEX         23. … <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> race     RACE        24. … <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> racecen1 RACECEN1    1602… <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> racecen2 RACECEN2    1602… <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> racecen3 RACECEN3    1602… <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> hispanic HISPANIC    1601… <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>     <span style="color: #949494;">&lt;tibble&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 618 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: marginals_2 &lt;list&gt;, marginals_3 &lt;list&gt;</span></span></span></code></pre></div>
<p>Each row is a variable. The <code>id</code>,
<code>description</code>, and <code>text</code> columns provide the
details on each question or measure. The <code>properties</code> and
<code>marginals</code> are provided in the remaining columns, with a
suffix indicating the wave.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lumley, Thomas (2010). <em>Complex Surveys: A Guide to Analysis Using
R</em>. New York: Wiley.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://kieranhealy.org" class="external-link">Kieran Healy</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
